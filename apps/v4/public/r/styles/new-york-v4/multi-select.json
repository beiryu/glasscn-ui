{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "multi-select",
  "registryDependencies": [
    "badge",
    "button",
    "command",
    "popover"
  ],
  "files": [
    {
      "path": "registry/new-york-v4/ui/multi-select.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { X, ChevronDown, Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Badge } from \"@/registry/new-york-v4/ui/badge\"\nimport { Button } from \"@/registry/new-york-v4/ui/button\"\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/registry/new-york-v4/ui/command\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/registry/new-york-v4/ui/popover\"\n\nexport interface MultiSelectOption {\n  label: string\n  value: string\n  icon?: React.ComponentType<{ className?: string }>\n}\n\ninterface MultiSelectProps {\n  options: MultiSelectOption[]\n  onValueChange: (value: string[]) => void\n  defaultValue?: string[]\n  placeholder?: string\n  animation?: number\n  maxCount?: number\n  modalPopover?: boolean\n  asChild?: boolean\n  className?: string\n}\n\nexport function MultiSelect({\n  options,\n  onValueChange,\n  defaultValue = [],\n  placeholder = \"Select items\",\n  animation = 0,\n  maxCount = 3,\n  modalPopover = false,\n  asChild = false,\n  className,\n  ...props\n}: MultiSelectProps) {\n  const [selectedValues, setSelectedValues] = React.useState<string[]>(defaultValue)\n  const [isPopoverOpen, setIsPopoverOpen] = React.useState(false)\n  const [isAnimating, setIsAnimating] = React.useState(false)\n\n  const handleInputKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Enter\") {\n      setIsPopoverOpen(true)\n    } else if (event.key === \"Backspace\" && !event.currentTarget.value) {\n      const newSelectedValues = [...selectedValues]\n      newSelectedValues.pop()\n      setSelectedValues(newSelectedValues)\n      onValueChange(newSelectedValues)\n    }\n  }\n\n  const toggleOption = (option: MultiSelectOption) => {\n    const newSelectedValues = selectedValues.includes(option.value)\n      ? selectedValues.filter((value) => value !== option.value)\n      : [...selectedValues, option.value]\n    setSelectedValues(newSelectedValues)\n    onValueChange(newSelectedValues)\n  }\n\n  const handleClear = () => {\n    setSelectedValues([])\n    onValueChange([])\n  }\n\n  const handleTogglePopover = () => {\n    setIsPopoverOpen((prev) => !prev)\n  }\n\n  const clearExtraOptions = () => {\n    const newSelectedValues = selectedValues.slice(0, maxCount)\n    setSelectedValues(newSelectedValues)\n    onValueChange(newSelectedValues)\n  }\n\n  const toggleAll = () => {\n    if (selectedValues.length === options.length) {\n      handleClear()\n    } else {\n      const allValues = options.map((option) => option.value)\n      setSelectedValues(allValues)\n      onValueChange(allValues)\n    }\n  }\n\n  return (\n    <Popover\n      open={isPopoverOpen}\n      onOpenChange={setIsPopoverOpen}\n      modal={modalPopover}\n    >\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          onClick={handleTogglePopover}\n          className={cn(\n            \"flex h-auto min-h-10 w-full items-center justify-between rounded-md border bg-inherit p-1 hover:bg-inherit\",\n            className\n          )}\n          {...props}\n        >\n          {selectedValues.length > 0 ? (\n            <div className=\"flex w-full items-center justify-between\">\n              <div className=\"flex flex-wrap items-center\">\n                {selectedValues.slice(0, maxCount).map((value) => {\n                  const option = options.find((o) => o.value === value)\n                  const IconComponent = option?.icon\n                  return (\n                    <Badge\n                      key={value}\n                      className={cn(\n                        \"m-1 bg-background text-foreground hover:bg-background\",\n                        isAnimating ? \"animate-bounce\" : \"\"\n                      )}\n                      style={{ animationDuration: `${animation}s` }}\n                    >\n                      {IconComponent && (\n                        <IconComponent className=\"mr-2 h-4 w-4\" />\n                      )}\n                      {option?.label}\n                      <X\n                        className=\"ml-2 h-4 w-4 cursor-pointer\"\n                        onClick={(event) => {\n                          event.stopPropagation()\n                          toggleOption(option!)\n                        }}\n                      />\n                    </Badge>\n                  )\n                })}\n                {selectedValues.length > maxCount && (\n                  <Badge\n                    className={cn(\n                      \"m-1 bg-transparent text-foreground hover:bg-transparent\",\n                      isAnimating ? \"animate-bounce\" : \"\"\n                    )}\n                    style={{ animationDuration: `${animation}s` }}\n                  >\n                    {`+ ${selectedValues.length - maxCount} more`}\n                    <X\n                      className=\"ml-2 h-4 w-4 cursor-pointer\"\n                      onClick={(event) => {\n                        event.stopPropagation()\n                        clearExtraOptions()\n                      }}\n                    />\n                  </Badge>\n                )}\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <X\n                  className=\"mx-2 h-4 cursor-pointer text-muted-foreground\"\n                  onClick={(event) => {\n                    event.stopPropagation()\n                    handleClear()\n                  }}\n                />\n                <ChevronDown className=\"h-4 cursor-pointer text-muted-foreground\" />\n              </div>\n            </div>\n          ) : (\n            <div className=\"mx-auto flex w-full items-center justify-between\">\n              <span className=\"mx-3 text-sm text-muted-foreground\">\n                {placeholder}\n              </span>\n              <ChevronDown className=\"mx-2 h-4 cursor-pointer text-muted-foreground\" />\n            </div>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent\n        className=\"w-auto p-0\"\n        align=\"start\"\n        onEscapeKeyDown={() => setIsPopoverOpen(false)}\n      >\n        <Command>\n          <CommandInput\n            placeholder=\"Search...\"\n            onKeyDown={handleInputKeyDown}\n          />\n          <CommandList>\n            <CommandEmpty>No results found.</CommandEmpty>\n            <CommandGroup>\n              <CommandItem\n                key=\"all\"\n                onSelect={toggleAll}\n                className=\"cursor-pointer\"\n              >\n                <div\n                  className={cn(\n                    \"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary\",\n                    selectedValues.length === options.length\n                      ? \"bg-primary text-primary-foreground\"\n                      : \"opacity-50 [&_svg]:invisible\"\n                  )}\n                >\n                  <Check className=\"h-4 w-4\" />\n                </div>\n                <span>(Select All)</span>\n              </CommandItem>\n              {options.map((option) => {\n                const isSelected = selectedValues.includes(option.value)\n                return (\n                  <CommandItem\n                    key={option.value}\n                    onSelect={() => toggleOption(option)}\n                    className=\"cursor-pointer\"\n                  >\n                    <div\n                      className={cn(\n                        \"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary\",\n                        isSelected\n                          ? \"bg-primary text-primary-foreground\"\n                          : \"opacity-50 [&_svg]:invisible\"\n                      )}\n                    >\n                      <Check className=\"h-4 w-4\" />\n                    </div>\n                    {option.icon && (\n                      <option.icon className=\"mr-2 h-4 w-4 text-muted-foreground\" />\n                    )}\n                    <span>{option.label}</span>\n                  </CommandItem>\n                )\n              })}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  )\n}\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}